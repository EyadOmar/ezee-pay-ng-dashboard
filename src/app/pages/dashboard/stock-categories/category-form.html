<div *transloco="let t" class="flex flex-col gap-6">
  <!-- Breadcrumb -->
  <p-breadcrumb [model]="breadcrumbItems()" [home]="homeItem()" styleClass="text-sm border-0 bg-transparent p-0" />

  <!-- Page Header -->
  <div class="flex items-center gap-3">
    <h2 class="text-xl font-semibold text-surface-900 dark:text-surface-900 m-0">
      {{ t(pageTitle()) }}
    </h2>
  </div>

  <!-- Form -->
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
      <!-- Name EN -->
      <app-form-field [label]="t('categories.form.nameEn')" for="nameEn" [required]="true">
        <input fluid pInputText id="nameEn" formControlName="nameEn" />
        @if (form.controls.nameEn.invalid && form.controls.nameEn.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.nameEnRequired') }}
          </p-message>
        }
      </app-form-field>

      <!-- Name AR -->
      <app-form-field [label]="t('categories.form.nameAr')" for="nameAr" [required]="true">
        <input fluid pInputText id="nameAr" formControlName="nameAr" dir="rtl" />
        @if (form.controls.nameAr.invalid && form.controls.nameAr.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.nameArRequired') }}
          </p-message>
        }
      </app-form-field>

      <!-- Description EN -->
      <app-form-field [label]="t('categories.form.descEn')" for="descEn">
        <textarea fluid pTextarea id="descEn" formControlName="descEn" rows="2"></textarea>
      </app-form-field>

      <!-- Description AR -->
      <app-form-field [label]="t('categories.form.descAr')" for="descAr">
        <textarea fluid pTextarea id="descAr" formControlName="descAr" rows="2" dir="rtl"></textarea>
      </app-form-field>
    </div>

    <!-- Parent Category (full width) -->
    <app-form-field [label]="t('categories.form.parent')" for="parentId">
      <p-select
        formControlName="parentId"
        [options]="parentCategories()"
        [optionLabel]="isAr() ? 'nameAr' : 'nameEn'"
        optionValue="id"
        [showClear]="true"
        fluid
        id="parentId"
      />
    </app-form-field>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
      <!-- Pricing Method -->
      <app-form-field [label]="t('categories.form.pricingMethod')" for="pricingMethod" [required]="true">
        <p-select
          formControlName="pricingMethod"
          [options]="pricingMethods"
          [optionLabel]="isAr() ? 'labelAr' : 'label'"
          optionValue="value"
          fluid
          id="pricingMethod"
        />
        @if (isInherited()) {
          <small class="text-primary flex items-center gap-1">
            <i class="pi pi-info-circle text-xs"></i>
            {{ t('categories.form.inheritedHint') }}
          </small>
        }
        @if (form.controls.pricingMethod.invalid && form.controls.pricingMethod.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.pricingMethodRequired') }}
          </p-message>
        }
      </app-form-field>

      <!-- Sales Strategy -->
      <app-form-field [label]="t('categories.form.salesStrategy')" for="salesStrategy" [required]="true">
        <p-select
          formControlName="salesStrategy"
          [options]="salesStrategies"
          [optionLabel]="isAr() ? 'labelAr' : 'label'"
          optionValue="value"
          fluid
          id="salesStrategy"
        />
        @if (isInherited()) {
          <small class="text-primary flex items-center gap-1">
            <i class="pi pi-info-circle text-xs"></i>
            {{ t('categories.form.inheritedHint') }}
          </small>
        }
        @if (form.controls.salesStrategy.invalid && form.controls.salesStrategy.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.salesStrategyRequired') }}
          </p-message>
        }
      </app-form-field>
    </div>

    <!-- Inactive Toggle (full width) -->
    <div class="flex items-center gap-3">
      <p-toggleswitch formControlName="inactive" inputId="inactive" />
      <label for="inactive" class="text-surface-700 dark:text-surface-700">
        {{ t('categories.form.inactive') }}
      </label>
    </div>

    <!-- Action Bar -->
    <div class="flex justify-end gap-2 pt-4 border-t border-surface-200 dark:border-surface-200">
      <p-button
        [label]="t('categories.cancel')"
        severity="secondary"
        [outlined]="true"
        (onClick)="onCancel()"
      />
      <p-button type="submit" [label]="t('categories.save')" icon="pi pi-check" />
    </div>
  </form>
</div>
