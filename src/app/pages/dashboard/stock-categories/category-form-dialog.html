<ng-container *transloco="let t">
  <p-dialog
    [header]="isEditMode() ? t('categories.editTitle') : t('categories.createTitle')"
    [(visible)]="visible"
    [modal]="true"
    [style]="{ width: '36rem' }"
    [dismissableMask]="true"
    (onHide)="onHide()"
  >
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-5 pt-2">
      <!-- Name EN -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <input fluid pInputText id="nameEn" formControlName="nameEn" />
          <label for="nameEn">{{ t('categories.form.nameEn') }}</label>
        </p-floatlabel>
        @if (form.controls.nameEn.invalid && form.controls.nameEn.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.nameEnRequired') }}
          </p-message>
        }
      </div>

      <!-- Name AR -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <input fluid pInputText id="nameAr" formControlName="nameAr" dir="rtl" />
          <label for="nameAr">{{ t('categories.form.nameAr') }}</label>
        </p-floatlabel>
        @if (form.controls.nameAr.invalid && form.controls.nameAr.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.nameArRequired') }}
          </p-message>
        }
      </div>

      <!-- Description EN -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <textarea fluid pTextarea id="descEn" formControlName="descEn" rows="2"></textarea>
          <label for="descEn">{{ t('categories.form.descEn') }}</label>
        </p-floatlabel>
      </div>

      <!-- Description AR -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <textarea fluid pTextarea id="descAr" formControlName="descAr" rows="2" dir="rtl"></textarea>
          <label for="descAr">{{ t('categories.form.descAr') }}</label>
        </p-floatlabel>
      </div>

      <!-- Parent Category -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <p-select
            formControlName="parentId"
            [options]="parentCategories()"
            [optionLabel]="isAr() ? 'nameAr' : 'nameEn'"
            optionValue="id"
            [showClear]="true"
            [placeholder]="t('categories.noParent')"
            fluid
            id="parentId"
          />
          <label for="parentId">{{ t('categories.form.parent') }}</label>
        </p-floatlabel>
      </div>

      <!-- Pricing Method -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <p-select
            formControlName="pricingMethod"
            [options]="pricingMethods"
            [optionLabel]="isAr() ? 'labelAr' : 'label'"
            optionValue="value"
            fluid
            id="pricingMethod"
          />
          <label for="pricingMethod">{{ t('categories.form.pricingMethod') }}</label>
        </p-floatlabel>
        @if (isInherited()) {
          <small class="text-primary flex items-center gap-1">
            <i class="pi pi-info-circle text-xs"></i>
            {{ t('categories.form.inheritedHint') }}
          </small>
        }
        @if (form.controls.pricingMethod.invalid && form.controls.pricingMethod.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.pricingMethodRequired') }}
          </p-message>
        }
      </div>

      <!-- Sales Strategy -->
      <div class="flex flex-col gap-1">
        <p-floatlabel variant="on">
          <p-select
            formControlName="salesStrategy"
            [options]="salesStrategies"
            [optionLabel]="isAr() ? 'labelAr' : 'label'"
            optionValue="value"
            fluid
            id="salesStrategy"
          />
          <label for="salesStrategy">{{ t('categories.form.salesStrategy') }}</label>
        </p-floatlabel>
        @if (isInherited()) {
          <small class="text-primary flex items-center gap-1">
            <i class="pi pi-info-circle text-xs"></i>
            {{ t('categories.form.inheritedHint') }}
          </small>
        }
        @if (form.controls.salesStrategy.invalid && form.controls.salesStrategy.touched) {
          <p-message severity="error" size="small" variant="simple">
            {{ t('categories.form.errors.salesStrategyRequired') }}
          </p-message>
        }
      </div>

      <!-- Inactive Toggle -->
      <div class="flex items-center gap-3">
        <p-toggleswitch formControlName="inactive" inputId="inactive" />
        <label for="inactive" class="text-surface-700 dark:text-surface-700">
          {{ t('categories.form.inactive') }}
        </label>
      </div>

      <!-- Actions -->
      <div class="flex justify-end gap-2 pt-2">
        <p-button
          [label]="t('categories.cancel')"
          severity="secondary"
          [outlined]="true"
          (onClick)="onHide()"
        />
        <p-button
          type="submit"
          [label]="t('categories.save')"
          icon="pi pi-check"
        />
      </div>
    </form>
  </p-dialog>
</ng-container>
