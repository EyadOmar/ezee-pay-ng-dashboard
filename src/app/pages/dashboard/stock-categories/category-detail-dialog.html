<ng-container *transloco="let t">
  <p-dialog
    [header]="t('categories.detailTitle')"
    [(visible)]="visible"
    [modal]="true"
    [style]="{ width: '34rem' }"
    [dismissableMask]="true"
    (onHide)="onHide()"
  >
    @if (category(); as cat) {
      <div class="flex flex-col gap-5 pt-2">
        <!-- Names -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.form.nameEn') }}
            </span>
            <span class="text-surface-900 dark:text-surface-900 font-medium">{{ cat.nameEn }}</span>
          </div>
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.form.nameAr') }}
            </span>
            <span class="text-surface-900 dark:text-surface-900 font-medium" dir="rtl">{{ cat.nameAr }}</span>
          </div>
        </div>

        <!-- Descriptions -->
        @if (cat.descEn || cat.descAr) {
          <div class="grid grid-cols-2 gap-4">
            @if (cat.descEn) {
              <div>
                <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
                  {{ t('categories.form.descEn') }}
                </span>
                <span class="text-surface-700 dark:text-surface-700">{{ cat.descEn }}</span>
              </div>
            }
            @if (cat.descAr) {
              <div>
                <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
                  {{ t('categories.form.descAr') }}
                </span>
                <span class="text-surface-700 dark:text-surface-700" dir="rtl">{{ cat.descAr }}</span>
              </div>
            }
          </div>
        }

        <!-- Parent -->
        <div>
          <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
            {{ t('categories.form.parent') }}
          </span>
          @if (parentCategory(); as parent) {
            <p-chip [label]="isAr() ? parent.nameAr : parent.nameEn" />
          } @else {
            <span class="text-surface-400">{{ t('categories.noParent') }}</span>
          }
        </div>

        <!-- Pricing & Strategy -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.form.pricingMethod') }}
            </span>
            <p-tag [value]="getPricingLabel(cat.pricingMethod)" severity="info" />
            @if (cat.parentId) {
              <span class="text-primary text-xs ms-2">{{ t('categories.inherited') }}</span>
            }
          </div>
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.form.salesStrategy') }}
            </span>
            <p-tag [value]="getSalesLabel(cat.salesStrategy)" severity="info" />
            @if (cat.parentId) {
              <span class="text-primary text-xs ms-2">{{ t('categories.inherited') }}</span>
            }
          </div>
        </div>

        <!-- Status -->
        <div>
          <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
            {{ t('categories.table.status') }}
          </span>
          @if (cat.inactive) {
            <p-tag [value]="t('categories.inactive')" severity="danger" />
          } @else {
            <p-tag [value]="t('categories.active')" severity="success" />
          }
        </div>

        <!-- Images -->
        @if (cat.images.length > 0) {
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-2">
              {{ t('categories.form.images') }}
            </span>
            <div class="flex gap-3 flex-wrap">
              @for (img of cat.images; track img.id) {
                <div class="relative">
                  <img
                    [src]="img.url"
                    [alt]="cat.nameEn"
                    class="w-20 h-20 object-cover rounded-lg border border-surface-200 dark:border-surface-200"
                  />
                  <span
                    class="absolute -top-2 -end-2 bg-primary text-white text-xs px-1.5 py-0.5 rounded-full"
                  >
                    {{ img.destination }}
                  </span>
                </div>
              }
            </div>
          </div>
        }

        <!-- Timestamps -->
        <div class="grid grid-cols-2 gap-4 pt-2 border-t border-surface-200 dark:border-surface-200">
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.createdAt') }}
            </span>
            <span class="text-surface-700 dark:text-surface-700 text-sm">
              {{ cat.createdAt | date: 'mediumDate' }}
            </span>
          </div>
          <div>
            <span class="text-surface-500 dark:text-surface-600 text-sm block mb-1">
              {{ t('categories.updatedAt') }}
            </span>
            <span class="text-surface-700 dark:text-surface-700 text-sm">
              {{ cat.updatedAt | date: 'mediumDate' }}
            </span>
          </div>
        </div>

        <!-- Close -->
        <div class="flex justify-end pt-2">
          <p-button
            [label]="t('categories.close')"
            severity="secondary"
            [outlined]="true"
            (onClick)="onHide()"
          />
        </div>
      </div>
    }
  </p-dialog>
</ng-container>
